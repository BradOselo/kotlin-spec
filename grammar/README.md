# Kotlin grammar

[![TeamCity (simple build status)](https://img.shields.io/teamcity/https/teamcity.jetbrains.com/e/Kotlin_spec_GrammarTests.svg?style=flat)](https://teamcity.jetbrains.com/viewType.html?buildTypeId=Kotlin_Spec_GrammarTests&branch_Kotlin_dev=%3Cdefault%3E&tab=buildTypeStatusDiv)

## Description

This subproject contains the Kotlin grammar source files in the ANTLR4 format and test infrastructure to testing the parser generated by grammar.

To testing, Kotlin compiler [PSI](https://github.com/JetBrains/kotlin/tree/master/compiler/testData/psi), Kotlin compiler [diagnostics](https://github.com/JetBrains/kotlin/tree/master/compiler/testData/diagnostics/tests) and own tests are used.

## How to use

To run the grammar tests, do the following:
1) Download compiler tests using the run script: `./getCompilerTests.sh` (you must have `svn` installed for this);
2) Prepare compiler diagnostics tests using gradle task: `./gradlew :grammar:prepareDiagnosticsCompilerTests`;
3) Remove not yet included tests if you want: `./gradlew :grammar:removeNewTests` (otherwise, those compiler tests for which the ANTLR parse tree has not yet been built and pushed will be used; therefore such tests will fail **on first run**);
4) Run tests: `./gradlew :grammar:test` (at this step, the grammar files are also automatically copied to `src/main/antlr` and a parser and lexer is generated to `src/main/java/{org.jetbrains.kotlin.grammar.parser}`).

## Artifacts

After build, the following artifact is available:
- **`kotlin-grammar-parser-{version}.jar`** contains `KotlinLexer` and `KotlinParser` classes generated by ANTLR4 using the grammar.

Artifact can be downloaded from [TeamCity configuration page](https://teamcity.jetbrains.com/viewType.html?buildTypeId=Kotlin_Spec_GrammarMaster).
Also, on this page **`kotlin-grammar-tools-{version}-{buildNo}.jar`** artifact is available, which is simple API to tokenize and parsing the Kotlin code (foo details, see [kotlin-grammar-tools](https://github.com/Kotlin/kotlin-grammar-tools) repository).

## Contributors
- [Mikhail Belyaev](https://github.com/belyaev-mikhail)
- [Marat Akhin](https://github.com/ice-phoenix)
- [Anastasiya Shadrina](https://github.com/shadrina)